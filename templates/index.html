<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Soulpull</title>
    <link rel="stylesheet" href="/static/app.css?v=ui-20260101-11" />
  </head>
  <body class="app" data-screen="connect">
    <div class="bg">
      <div class="bg__blob bg__blob--1"></div>
      <div class="bg__blob bg__blob--2"></div>
      <div class="bg__grid"></div>
    </div>

    <header class="topbar">
      <div class="topbar__left">
        <div class="logo">
          <span class="logo__mark">S</span>
          <span class="logo__text">Soulpull</span>
        </div>
        <div class="badge" id="build-badge">MVP</div>
        <div class="tg-user hidden" id="tg-user">
          <img class="tg-user__avatar" id="tg-user-avatar" alt="Telegram avatar" />
          <div class="tg-user__meta">
            <div class="tg-user__name" id="tg-user-name"></div>
            <div class="tg-user__username" id="tg-user-username"></div>
          </div>
        </div>
      </div>
      <div class="topbar__right">
        <div class="tonconnect-slot" id="tonconnect"></div>
      </div>
    </header>

    <main class="container">
      <div id="tg-warning" class="notice hidden">
        Откройте через Telegram WebApp, чтобы привязать Telegram.
      </div>

      <div class="steps">
        <div class="steps__item" data-step="connect">
          <div class="steps__dot"></div>
          <div class="steps__label">Connect</div>
        </div>
        <div class="steps__line"></div>
        <div class="steps__item" data-step="onboarding">
          <div class="steps__dot"></div>
          <div class="steps__label">Onboarding</div>
        </div>
        <div class="steps__line"></div>
        <div class="steps__item" data-step="cabinet">
          <div class="steps__dot"></div>
          <div class="steps__label">Cabinet</div>
        </div>
      </div>

      <div class="layout">
        <section class="panel panel--main">
          <section id="screen-connect" class="screen">
            <div class="hero">
              <h1 class="hero__title">Подключите кошелёк</h1>
              <p class="hero__sub">
                Кошелёк = аккаунт. Мы делаем авторизацию через <span class="kbd">TON Proof</span>.
              </p>
              <div class="hero__hint">
                Шаг 1: нажмите кнопку ниже, выберите <b>Tonkeeper</b> и подтвердите подключение.
              </div>
              <div class="stack mt">
                <button id="btn-open-tonconnect" class="btn btn-indigo btn-lg">Подключить кошелёк (TonConnect)</button>
                <div class="muted">Если кнопка не открывается — нажмите TonConnect в правом верхнем углу.</div>
              </div>
            </div>
          </section>

          <section id="screen-onboarding" class="screen hidden">
            <div class="hero hero--compact">
              <h1 class="hero__title">Онбординг</h1>
              <p class="hero__sub">Следуйте шагам ниже — мы подскажем, что нажимать дальше.</p>
            </div>

            <div class="cards">
              <div class="card card--glass">
                <div class="card__head">
                  <div class="card__title">Что дальше</div>
                  <div class="pill" id="next-pill">—</div>
                </div>
                <div class="checklist" id="checklist">
                  <div class="checklist__row"><span class="checklist__k">Кошелёк подключён</span><span class="tag" id="chk-wallet">—</span></div>
                  <div class="checklist__row"><span class="checklist__k">Telegram привязан</span><span class="tag" id="chk-telegram">—</span></div>
                  <div class="checklist__row"><span class="checklist__k">Кто пригласил (telegram_id)</span><span class="tag" id="chk-referrer">—</span></div>
                  <div class="checklist__row"><span class="checklist__k">Код автора</span><span class="tag" id="chk-code">—</span></div>
                  <div class="checklist__row"><span class="checklist__k">Оплата отправлена (3 USDT)</span><span class="tag" id="chk-paid">—</span></div>
                  <div class="checklist__row"><span class="checklist__k">Подтверждено админом</span><span class="tag" id="chk-confirmed">—</span></div>
                </div>
                <div class="stack mt">
                  <button id="btn-next-action" class="btn btn-indigo">Сделать следующий шаг</button>
                  <div class="muted" id="next-hint">—</div>
                </div>
              </div>

              <div class="card card--glass">
                <div class="card__head">
                  <div class="card__title">Сессия</div>
                  <div class="pill" id="status">init</div>
                </div>
                <div class="kv">
                  <div class="kv__row">
                    <div class="kv__k">Wallet</div>
                    <div class="kv__v mono" id="wallet-address"></div>
                  </div>
                  <div class="kv__row">
                    <div class="kv__k">Telegram</div>
                    <div class="kv__v" id="telegram-info">—</div>
                  </div>
                  <div class="kv__row">
                    <div class="kv__k">Inviter</div>
                    <div class="kv__v" id="inviter-info">—</div>
                  </div>
                  <div class="kv__row">
                    <div class="kv__k">Author code</div>
                    <div class="kv__v" id="author-code-info">—</div>
                  </div>
                </div>
              </div>

              <div class="card">
                <div class="card__head">
                  <div class="card__title">Telegram WebApp</div>
                  <div class="card__desc">Привязка профиля Telegram к кошельку.</div>
                </div>
                <button id="btn-telegram-verify" class="btn btn-indigo">Привязать Telegram</button>
              </div>

              <div class="card">
                <div class="card__head">
                  <div class="card__title">Кто пригласил</div>
                  <div class="card__desc"><b>Обязательно</b>: telegram_id пригласившего (только цифры).</div>
                </div>
                <div class="field">
                  <input id="inviter-input" class="input" placeholder="telegram_id (например: 123456789)" />
                  <button id="btn-inviter-apply" class="btn">Сохранить</button>
                </div>
              </div>

              <div class="card">
                <div class="card__head">
                  <div class="card__title">Код автора</div>
                  <div class="card__desc"><b>Обязательно</b>. Можно применить один раз.</div>
                </div>
                <div class="field">
                  <input id="author-code-input" class="input" placeholder="Например: INDIGO15" />
                  <button id="btn-author-code-apply" class="btn">Применить</button>
                </div>
              </div>

              <div class="card card--accent">
                <div class="card__head">
                  <div class="card__title">Оплата</div>
                  <div class="card__desc">Шаг 5: оплатите <b>3 USDT</b> через Tonkeeper. После оплаты вставьте tx hash для ручной проверки.</div>
                </div>
                <div class="stack">
                  <button id="btn-pay-create" class="btn btn-indigo btn-lg">Оплатить 3 USDT</button>
                  <div id="payment-info" class="muted"></div>
                  <button id="btn-pay-send" class="btn mt hidden">Отправить через кошелёк</button>
                  <div class="field mt">
                    <input id="tx-hash-input" class="input" placeholder="Tx hash (для MVP)" />
                    <button id="btn-pay-confirm" class="btn">Подтвердить</button>
                  </div>
                </div>
              </div>
            </div>
          </section>

          <section id="screen-cabinet" class="screen hidden">
            <div class="hero hero--compact">
              <h1 class="hero__title">Кабинет</h1>
              <p class="hero__sub">Ваш профиль и статус участия.</p>
            </div>

            <div class="card card--glass">
              <div class="kv">
                <div class="kv__row"><div class="kv__k">Wallet</div><div class="kv__v mono" id="cab-wallet">—</div></div>
                <div class="kv__row"><div class="kv__k">Telegram</div><div class="kv__v" id="cab-telegram">—</div></div>
                <div class="kv__row"><div class="kv__k">Inviter</div><div class="kv__v" id="cab-inviter">—</div></div>
                <div class="kv__row"><div class="kv__k">Author code</div><div class="kv__v" id="cab-author-code">—</div></div>
                <div class="kv__row"><div class="kv__k">Status</div><div class="kv__v" id="cab-status">—</div></div>
                <div class="kv__row"><div class="kv__k">Stats</div><div class="kv__v" id="cab-stats">—</div></div>
              </div>
            </div>

            <div class="cards">
              <div class="card">
                <div class="card__head">
                  <div class="card__title">Выплата</div>
                  <div class="card__desc">Когда выполнены условия, можно запросить выплату <b>$1</b>.</div>
                </div>
                <div class="stack">
                  <button id="btn-payout-request" class="btn btn-indigo" disabled>Запросить выплату $1</button>
                  <div class="muted" id="payout-hint">—</div>
                  <div class="muted" id="payout-list"></div>
                </div>
              </div>
            </div>
          </section>
        </section>

        <aside class="panel panel--side">
          <div class="card card--glass">
            <div class="card__head">
              <div class="card__title">Подсказки</div>
              <div class="card__desc">Что делать дальше</div>
            </div>
            <ul class="tips">
              <li><b>1)</b> Подключите кошелёк (TonConnect).</li>
              <li><b>2)</b> Нажмите «Привязать Telegram».</li>
              <li><b>3)</b> Введите <b>telegram_id</b> пригласившего.</li>
              <li><b>4)</b> Введите <b>код автора</b>.</li>
              <li><b>5)</b> Нажмите «Оплатить 3 USDT» → «Отправить через кошелёк».</li>
              <li><b>6)</b> Вставьте tx hash → админ подтверждает.</li>
            </ul>
          </div>

          <div class="card">
            <div class="card__head">
              <div class="card__title">Статус</div>
              <div class="card__desc">Живые обновления</div>
            </div>
            <div class="toast" id="toast">init</div>
            <div class="stack mt">
              <button id="btn-refresh" class="btn">Обновить данные (без перезагрузки)</button>
              <div class="muted">Не используйте refresh страницы в Telegram — он сбрасывает сессию кошелька.</div>
            </div>
          </div>

          <details class="details">
            <summary class="details__summary">Страж (админ)</summary>
            <div class="card mt">
              <div class="stack">
                <input id="admin-token" class="input" placeholder="X-Admin-Token" />
                <button id="btn-admin-refresh" class="btn">Обновить списки</button>
                <div class="muted" id="admin-status"></div>
                <div class="muted" id="admin-pending"></div>
                <div class="muted" id="admin-payouts"></div>
              </div>
            </div>
          </details>
        </aside>
      </div>
    </main>

    <script src="https://unpkg.com/tonweb@0.0.66/dist/tonweb.js"></script>
    <script src="https://unpkg.com/@tonconnect/ui@2.0.0/dist/tonconnect-ui.min.js"></script>
    <script src="/static/js/app.js?v=app-20260101-11"></script>
  </body>
</html>



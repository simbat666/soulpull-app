#!/bin/bash
# –°–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ä–≤–µ—Ä–∞

echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ä–≤–µ—Ä–∞ Soulpull..."
echo ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ systemd —Å–µ—Ä–≤–∏—Å–∞
echo "1. –°—Ç–∞—Ç—É—Å systemd —Å–µ—Ä–≤–∏—Å–∞:"
sudo systemctl status soulpull-backend --no-pager -l | head -20
echo ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ nginx
echo "2. –°—Ç–∞—Ç—É—Å nginx:"
sudo systemctl status nginx --no-pager -l | head -10
echo ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤
echo "3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤:"
echo "–ü–æ—Ä—Ç 8000 (Django):"
sudo netstat -tlnp | grep :8000 || echo "  ‚ùå –ü–æ—Ä—Ç 8000 –Ω–µ —Å–ª—É—à–∞–µ—Ç—Å—è"
echo ""
echo "–ü–æ—Ä—Ç 80 (HTTP):"
sudo netstat -tlnp | grep :80 || echo "  ‚ùå –ü–æ—Ä—Ç 80 –Ω–µ —Å–ª—É—à–∞–µ—Ç—Å—è"
echo ""
echo "–ü–æ—Ä—Ç 443 (HTTPS):"
sudo netstat -tlnp | grep :443 || echo "  ‚ùå –ü–æ—Ä—Ç 443 –Ω–µ —Å–ª—É—à–∞–µ—Ç—Å—è"
echo ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
echo "4. –ü—Ä–æ—Ü–µ—Å—Å—ã Django/Gunicorn:"
ps aux | grep -E "(gunicorn|manage.py)" | grep -v grep || echo "  ‚ùå –ü—Ä–æ—Ü–µ—Å—Å—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"
echo ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
echo "5. –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ—à–∏–±–∫–∏ –∏–∑ –ª–æ–≥–æ–≤:"
if [ -f /var/log/soulpull-backend/error.log ]; then
    echo "--- –ü–æ—Å–ª–µ–¥–Ω–∏–µ 10 —Å—Ç—Ä–æ–∫ error.log ---"
    tail -10 /var/log/soulpull-backend/error.log
else
    echo "  –õ–æ–≥ —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω"
fi
echo ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ª–æ–∫–∞–ª—å–Ω–æ
echo "6. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏:"
curl -I http://localhost:8000 2>&1 | head -5 || echo "  ‚ùå –õ–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç"
echo ""

echo "‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞"

